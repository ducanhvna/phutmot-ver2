{% extends 'layouts/base.html' %}

{% block content %}
  <div class="page-header d-flex justify-content-between align-items-center">
    <h2 class="h4 mb-0">Product Master</h2>
  </div>

  <div class="card mt-3">
    <div class="card-body p-2">
      <div class="table-responsive" style="overflow:auto;">
        <table class="table table-bordered table-hover" style="table-layout: auto; width: max-content; white-space: normal;">
          <thead class="table-light">
            <tr>
              {% for g in groups_data %}
                <th style="vertical-align: middle; background:#f8f9fa; text-align:center;" colspan="{{ g.total_cols }}">
                  {{ g.obj.display_name|default:g.obj.name }}
                </th>
              {% endfor %}
            </tr>

            <tr>
              {% for g in groups_data %}
                {% for s in g.subgroups %}
                  <th style="vertical-align: middle; background:#f1f3f5; text-align:center;" colspan="{{ s.attributes|length }}">
                    {% if s.obj %}
                      {{ s.obj.display_name|default:s.obj.name }}
                    {% else %}
                      -
                    {% endif %}
                  </th>
                {% endfor %}
              {% endfor %}
            </tr>

            <tr>
              {% for attr in flat_attributes %}
                <th style="vertical-align: middle; text-align:left; min-width:220px; padding:12px;">
                  {{ attr.name }}
                </th>
              {% endfor %}
            </tr>
          </thead>

          <tbody>
            {% for row in body_rows %}
              <tr>
                {% for cell in row %}
                  <td style="vertical-align: top; min-width:220px; padding:12px; word-break: break-word; white-space: normal;">
                    {% if cell %}
                      <div style="white-space: pre-wrap;">{{ cell }}</div>
                    {% else %}
                      {# để trống theo yêu cầu (không hiển thị '-') #}
                    {% endif %}
                  </td>
                {% endfor %}
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <style>
    table.table thead th, table.table tbody td {
      vertical-align: top;
      white-space: normal;
      word-break: break-word;
    }
    table.table th, table.table td { padding: 12px; }
  </style>
{% endblock %}
