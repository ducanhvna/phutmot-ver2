{% extends "layouts/base.html" %}

{% block title %} Tables {% endblock %} 

{% block stylesheets %}
<style>
    .calendar {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 10px;
    }
    .day {
        border: 1px solid #ccc;
        padding: 10px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        cursor: pointer;  /* Thêm hiệu ứng con trỏ cho ô ngày */
    }
    .day > div {
        padding: 5px;
        border-bottom: 1px solid #eee;
    }
    .date {
        grid-column: 1 / span 2;  /* Chiếm 2 cột */
        border-bottom: none;
        font-weight: bold;
    }
    .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgb(0,0,0);
        background-color: rgba(0,0,0,0.4);
    }
    .modal-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
    }
    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }
    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }
</style>
{% endblock stylesheets %}

{% block content %}
  <div class="content">
    <h1>Lịch công tác</h1>
    <div class="calendar">
        {% for day in calendar_data %}
        <div class="day" data-date="{{ day.date }}" onclick="openModal(this)">
            <div class="date">{{ day.date }}</div>
            <div class="order-count">{{ day.order_count }}</div>
            <div class="work-hours">{{ day.work_hours }}</div>
            <div class="salary">{{ day.salary }}</div>
        </div>
        {% endfor %}
    </div>

    <!-- Popup Modal -->
    <div id="myModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <div id="modalContent"></div>
      </div>
    </div>
  </div>
{% endblock content %}

{% block javascripts %}
<script>
    function openModal(element) {
        var date = element.getAttribute("data-date");
        fetch(`/api/get_details?date=${date}`)
            .then(response => response.json())
            .then(data => {
                document.getElementById("modalContent").innerHTML = `
                    <h4>Chi tiết ngày: ${date}</h4>
                    <p>Số lượng đơn: ${data.order_count}</p>
                    <p>Thời gian đi làm: ${data.work_hours}</p>
                    <p>Công tính lương: ${data.salary}</p>
                `;
                document.getElementById("myModal").style.display = "block";
            });
    }

    function closeModal() {
        document.getElementById("myModal").style.display = "none";
    }
</script>
{% endblock javascripts %}
